=== TRAINING ===
2026-01-06 00:38:29,655 - chuk_lazarus.cli.commands.train.sft - INFO - Loading model: meta-llama/Llama-3.2-1B
Fetching 8 files:   0%|          | 0/8 [00:00<?, ?it/s]Fetching 8 files: 100%|██████████| 8/8 [00:00<00:00, 19184.92it/s]
2026-01-06 00:38:30,263 - chuk_lazarus.cli.commands.train.sft - INFO -   Model loaded: 16 layers
2026-01-06 00:38:30,264 - chuk_lazarus.models_v2.adapters.lora - INFO - Applied LoRA to 64 layers
2026-01-06 00:38:30,264 - chuk_lazarus.cli.commands.train.sft - INFO -   Applied LoRA: 64 layers, 1,703,936 trainable params
2026-01-06 00:38:30,264 - chuk_lazarus.cli.commands.train.sft - INFO - Loading dataset: experiments/cli_classifier_emergence/train.jsonl
2026-01-06 00:38:30,271 - chuk_lazarus.data.sft_dataset - INFO - Loaded 4500 SFT samples from experiments/cli_classifier_emergence/train.jsonl
2026-01-06 00:38:30,271 - chuk_lazarus.cli.commands.train.sft - INFO -   Loaded 4500 training samples
2026-01-06 00:38:30,272 - chuk_lazarus.data.sft_dataset - INFO - Loaded 500 SFT samples from experiments/cli_classifier_emergence/eval.jsonl
2026-01-06 00:38:30,272 - chuk_lazarus.cli.commands.train.sft - INFO -   Loaded 500 eval samples
2026-01-06 00:38:30,272 - chuk_lazarus.cli.commands.train.sft - INFO - Starting training...
2026-01-06 00:38:30,272 - chuk_lazarus.training.trainers.sft_trainer - INFO - Starting SFT training with 4500 samples
2026-01-06 00:38:30,272 - chuk_lazarus.training.base_trainer - INFO - Starting training for 3 epochs
2026-01-06 00:38:30,272 - chuk_lazarus.training.base_trainer - INFO - Config: SFTConfig(learning_rate=0.0001, weight_decay=0.0, max_grad_norm=1.0, log_interval=10, checkpoint_interval=500, checkpoint_dir='experiments/cli_classifier_emergence/checkpoint/checkpoints', max_steps=500, num_epochs=3, batch_size=8, warmup_steps=100, eval_interval=100, min_loss=None)
2026-01-06 00:38:30,272 - chuk_lazarus.training.base_trainer - INFO - Epoch 1/3
2026-01-06 00:38:31,590 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 10 | Loss: 3.8343 | PPL: 167.04 | Tok/s: 0 | Time: 1.3s
2026-01-06 00:38:32,770 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 20 | Loss: 2.0199 | PPL: 7.71 | Tok/s: 0 | Time: 2.5s
2026-01-06 00:38:33,943 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 30 | Loss: 1.9030 | PPL: 6.81 | Tok/s: 0 | Time: 3.7s
2026-01-06 00:38:35,116 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 40 | Loss: 1.7982 | PPL: 6.06 | Tok/s: 0 | Time: 4.8s
2026-01-06 00:38:36,286 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 50 | Loss: 1.4308 | PPL: 4.22 | Tok/s: 0 | Time: 6.0s
2026-01-06 00:38:37,468 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 60 | Loss: 1.3484 | PPL: 3.88 | Tok/s: 0 | Time: 7.2s
2026-01-06 00:38:38,639 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 70 | Loss: 1.3324 | PPL: 3.80 | Tok/s: 0 | Time: 8.4s
2026-01-06 00:38:39,813 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 80 | Loss: 1.3366 | PPL: 3.81 | Tok/s: 0 | Time: 9.5s
2026-01-06 00:38:40,988 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 90 | Loss: 1.2978 | PPL: 3.68 | Tok/s: 0 | Time: 10.7s
2026-01-06 00:38:42,160 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 100 | Loss: 1.3399 | PPL: 3.83 | Tok/s: 0 | Time: 11.9s
2026-01-06 00:38:46,533 - chuk_lazarus.training.trainers.sft_trainer - INFO - Eval | Loss: 1.3253 | PPL: 3.77
2026-01-06 00:38:47,716 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 110 | Loss: 1.3477 | PPL: 3.86 | Tok/s: 0 | Time: 17.4s
2026-01-06 00:38:48,889 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 120 | Loss: 1.3328 | PPL: 3.80 | Tok/s: 0 | Time: 18.6s
2026-01-06 00:38:50,066 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 130 | Loss: 1.3229 | PPL: 3.76 | Tok/s: 0 | Time: 19.8s
2026-01-06 00:38:51,248 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 140 | Loss: 1.2554 | PPL: 3.51 | Tok/s: 0 | Time: 21.0s
2026-01-06 00:38:52,429 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 150 | Loss: 1.3209 | PPL: 3.75 | Tok/s: 0 | Time: 22.2s
2026-01-06 00:38:53,608 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 160 | Loss: 1.3006 | PPL: 3.68 | Tok/s: 0 | Time: 23.3s
2026-01-06 00:38:54,788 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 170 | Loss: 1.3464 | PPL: 3.86 | Tok/s: 0 | Time: 24.5s
2026-01-06 00:38:55,966 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 180 | Loss: 1.2887 | PPL: 3.63 | Tok/s: 0 | Time: 25.7s
2026-01-06 00:38:57,145 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 190 | Loss: 1.3398 | PPL: 3.83 | Tok/s: 0 | Time: 26.9s
2026-01-06 00:38:58,328 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 200 | Loss: 1.2814 | PPL: 3.61 | Tok/s: 0 | Time: 28.1s
2026-01-06 00:39:02,745 - chuk_lazarus.training.trainers.sft_trainer - INFO - Eval | Loss: 1.3061 | PPL: 3.70
2026-01-06 00:39:03,927 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 210 | Loss: 1.2775 | PPL: 3.60 | Tok/s: 0 | Time: 33.7s
2026-01-06 00:39:05,107 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 220 | Loss: 1.3089 | PPL: 3.72 | Tok/s: 0 | Time: 34.8s
2026-01-06 00:39:06,291 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 230 | Loss: 1.2987 | PPL: 3.68 | Tok/s: 0 | Time: 36.0s
2026-01-06 00:39:07,470 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 240 | Loss: 1.3000 | PPL: 3.68 | Tok/s: 0 | Time: 37.2s
2026-01-06 00:39:08,651 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 250 | Loss: 1.2898 | PPL: 3.64 | Tok/s: 0 | Time: 38.4s
2026-01-06 00:39:09,833 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 260 | Loss: 1.2734 | PPL: 3.58 | Tok/s: 0 | Time: 39.6s
2026-01-06 00:39:11,015 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 270 | Loss: 1.3254 | PPL: 3.77 | Tok/s: 0 | Time: 40.7s
2026-01-06 00:39:12,201 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 280 | Loss: 1.3429 | PPL: 3.83 | Tok/s: 0 | Time: 41.9s
2026-01-06 00:39:13,392 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 290 | Loss: 1.2919 | PPL: 3.65 | Tok/s: 0 | Time: 43.1s
2026-01-06 00:39:14,578 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 300 | Loss: 1.2860 | PPL: 3.63 | Tok/s: 0 | Time: 44.3s
2026-01-06 00:39:19,007 - chuk_lazarus.training.trainers.sft_trainer - INFO - Eval | Loss: 1.3032 | PPL: 3.69
2026-01-06 00:39:20,169 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 310 | Loss: 1.3047 | PPL: 3.69 | Tok/s: 0 | Time: 49.9s
2026-01-06 00:39:21,324 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 320 | Loss: 1.2534 | PPL: 3.52 | Tok/s: 0 | Time: 51.1s
2026-01-06 00:39:22,482 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 330 | Loss: 1.3447 | PPL: 3.85 | Tok/s: 0 | Time: 52.2s
2026-01-06 00:39:23,650 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 340 | Loss: 1.3077 | PPL: 3.70 | Tok/s: 0 | Time: 53.4s
2026-01-06 00:39:24,840 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 350 | Loss: 1.2510 | PPL: 3.50 | Tok/s: 0 | Time: 54.6s
2026-01-06 00:39:26,029 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 360 | Loss: 1.2410 | PPL: 3.47 | Tok/s: 0 | Time: 55.8s
2026-01-06 00:39:27,219 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 370 | Loss: 1.3304 | PPL: 3.79 | Tok/s: 0 | Time: 56.9s
2026-01-06 00:39:28,410 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 380 | Loss: 1.3385 | PPL: 3.82 | Tok/s: 0 | Time: 58.1s
2026-01-06 00:39:29,594 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 390 | Loss: 1.3098 | PPL: 3.71 | Tok/s: 0 | Time: 59.3s
2026-01-06 00:39:30,781 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 400 | Loss: 1.2996 | PPL: 3.67 | Tok/s: 0 | Time: 60.5s
2026-01-06 00:39:35,205 - chuk_lazarus.training.trainers.sft_trainer - INFO - Eval | Loss: 1.3082 | PPL: 3.71
2026-01-06 00:39:36,367 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 410 | Loss: 1.2941 | PPL: 3.66 | Tok/s: 0 | Time: 66.1s
2026-01-06 00:39:37,528 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 420 | Loss: 1.2915 | PPL: 3.65 | Tok/s: 0 | Time: 67.3s
2026-01-06 00:39:38,717 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 430 | Loss: 1.2705 | PPL: 3.57 | Tok/s: 0 | Time: 68.4s
2026-01-06 00:39:39,906 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 440 | Loss: 1.2778 | PPL: 3.60 | Tok/s: 0 | Time: 69.6s
2026-01-06 00:39:41,095 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 450 | Loss: 1.3209 | PPL: 3.76 | Tok/s: 0 | Time: 70.8s
2026-01-06 00:39:42,284 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 460 | Loss: 1.2930 | PPL: 3.65 | Tok/s: 0 | Time: 72.0s
2026-01-06 00:39:43,475 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 470 | Loss: 1.3083 | PPL: 3.71 | Tok/s: 0 | Time: 73.2s
2026-01-06 00:39:44,670 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 480 | Loss: 1.3220 | PPL: 3.76 | Tok/s: 0 | Time: 74.4s
2026-01-06 00:39:45,857 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 490 | Loss: 1.2472 | PPL: 3.49 | Tok/s: 0 | Time: 75.6s
2026-01-06 00:39:47,047 - chuk_lazarus.training.trainers.sft_trainer - INFO - Step 500 | Loss: 1.3230 | PPL: 3.76 | Tok/s: 0 | Time: 76.8s
2026-01-06 00:39:51,517 - chuk_lazarus.training.trainers.sft_trainer - INFO - Eval | Loss: 1.3079 | PPL: 3.71
2026-01-06 00:39:51,584 - chuk_lazarus.training.base_trainer - INFO - Saved checkpoint: experiments/cli_classifier_emergence/checkpoint/checkpoints/best.safetensors
2026-01-06 00:39:51,654 - chuk_lazarus.training.base_trainer - INFO - Saved checkpoint: experiments/cli_classifier_emergence/checkpoint/checkpoints/step_500.safetensors
2026-01-06 00:39:51,654 - chuk_lazarus.training.base_trainer - INFO - Reached max steps (500)
2026-01-06 00:39:51,733 - chuk_lazarus.training.base_trainer - INFO - Saved checkpoint: experiments/cli_classifier_emergence/checkpoint/checkpoints/final.safetensors
2026-01-06 00:39:51,733 - chuk_lazarus.training.base_trainer - INFO - Training complete. Total steps: 500
2026-01-06 00:39:51,738 - chuk_lazarus.cli.commands.train.sft - INFO - Saved LoRA adapters to experiments/cli_classifier_emergence/checkpoint/adapters
2026-01-06 00:39:51,738 - chuk_lazarus.cli.commands.train.sft - INFO - Training complete. Output saved to experiments/cli_classifier_emergence/checkpoint

============================================================
SFT Training Complete
============================================================
  Mode: sft
  Epochs: 3
  Checkpoints: experiments/cli_classifier_emergence/checkpoint
